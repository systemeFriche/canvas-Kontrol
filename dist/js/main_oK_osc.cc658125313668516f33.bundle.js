!function(t){var e={};function s(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(i,a,function(e){return t[e]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=15)}({13:function(t,e,s){},14:function(t,e,s){},15:function(t,e,s){"use strict";s.r(e);s(13);var i=class{constructor(t,e){this.ws=new osc.WebSocketPort({url:"ws://"+t+":"+e,metadata:!0}),this.ws.connexionState=!1,this.ws.open(),this.ws.on("ready",function(){console.log("Liaison ouverte..."),this.connexionState=!0}),this.ws.receptionMessageOsc=function(){},this.ws.on("message",function(t){this.receptionMessageOsc(t)})}sendValueOsc(t){console.log("SENT : adresse OSC :"+t.adresseOsc+",type valeur "+t.typeVal+",valeur : "+t.value),this.ws.send({address:t.adresseOsc,args:[{type:t.typeVal,value:t.value}]})}};var a=class{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.width=t.width,this.height=t.width,this.scale=t.scale,this.styleBorder=t.styleBorder,this.couleur=t.couleur,this.onValueChange=t.onvaluechange||function(){},this.adresseOsc=t.adresseOsc}initInterface(){var t=document.createElement("canvas");t.addEventListener("mousedown",this.clic.bind(this)),t.id=this.id+"-canvas",t.className="bang",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawCercle()}clic(){this.drawCercle(),this.drawBang();let t={adresseOsc:this.adresseOsc,typeVal:"i",value:"1"};this.onValueChange(t),setTimeout(function(){this.drawCercle()}.bind(this),100)}drawCercle(){this.ctx.clearRect(0,0,300,300),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle="rgba("+this.couleur+",1)",this.ctx.arc(150,150,100,0,2*Math.PI,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.font="24pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.legende,150,25)}drawBang(){this.ctx.beginPath(),this.ctx.lineWidth=0,this.ctx.strokeStyle="rgba("+this.couleur+",0.5)",this.ctx.fillStyle="rgba("+this.couleur+",0.5)",this.ctx.arc(150,150,80,0,2*Math.PI,!1),this.ctx.fill(),this.ctx.closePath()}};class l{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.angleDepart=l.conversionAngle(t.angleDepart||0),this.angleArrivee=l.conversionAngle(t.angleArrivee||360),this.typeVal=t.typeVal,this.valeurMin=t.valeurMin||0,this.valeurMax=t.valeurMax||100,this.largeurCurseur=Math.PI/12,this.valeurA=t.valeur,this.valeurB=t.valeur,this.etatClic=!1,this.sourisY=0,this.couleur=t.couleur,document.body.addEventListener("mouseup",this.sourisUp.bind(this)),document.body.addEventListener("mousemove",this.getSouris.bind(this)),this.onValueChange=t.onvaluechange||function(){},this.width=t.width,this.height=t.height,this.scale=t.scale,this.adresseOsc=t.adresseOsc}initInterface(){var t=document.createElement("canvas");t.addEventListener("mousedown",this.sourisDown.bind(this)),t.id=this.id+"-canvas",t.className="knob",t.width=this.width,t.height=this.height,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),t.setAttribute("data-angle-depart",this.angleDepart),t.setAttribute("data-angle-arrivee",this.angleArrivee),t.setAttribute("data-valeur-min",this.valeurMin),t.setAttribute("data-valeur-max",this.valeurMax),t.setAttribute("data-valeur-init",this.valeurA),t.setAttribute("data-type-val",this.typeVal),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawKnob()}setvaleurA(t){this.valeurA=t,this.drawKnob()}setvaleurB(t){this.valeurB=t,this.drawKnob();let e={adresseOsc:this.adresseOsc,typeVal:this.typeVal,value:t};this.onValueChange(e)}sourisDown(t){this.sourisY=t.clientY,this.etatClic=!0}sourisUp(){this.etatClic&&this.setvaleurA(this.valeurB),this.etatClic=!1}getSouris(t){if(this.etatClic){let e=this.valeurA+(this.sourisY-t.clientY)/(2*this.height/3)*(this.valeurMax-this.valeurMin);e<this.valeurMin?e=this.valeurMin:e>this.valeurMax&&(e=this.valeurMax),e="i"===this.typeVal?parseInt(e):Math.round(100*e)/100,this.setvaleurB(e)}}miseEchelle(t){return(this.angleArrivee-this.angleDepart-2*this.largeurCurseur)*(t-this.valeurMin)/(this.valeurMax-this.valeurMin)+(this.angleDepart+this.largeurCurseur)}drawKnob(){this.ctx.clearRect(0,0,300,300),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle="rgba("+this.couleur+",1)",this.ctx.arc(150,150,100,this.angleDepart,this.angleArrivee,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.font="24pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.legende,150,25),this.drawCursorKnob(),this.drawTexteKnob()}drawCursorKnob(){let t;this.ctx.beginPath(),this.ctx.lineWidth=15,this.ctx.strokeStyle="rgba("+this.couleur+",0.31)",t=this.miseEchelle(this.valeurA),this.ctx.arc(150,150,85,t-this.largeurCurseur,t+this.largeurCurseur,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.lineWidth=15,this.ctx.strokeStyle="rgba("+this.couleur+",1)",t=this.miseEchelle(this.valeurB),this.ctx.arc(150,150,85,t-this.largeurCurseur,t+this.largeurCurseur,!1),this.ctx.stroke(),this.ctx.closePath()}drawTexteKnob(){this.ctx.font="30pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(l.convertValue(this.valeurB),150,150),this.ctx.font="22pt Verdana",this.ctx.fillText(l.convertValue(this.valeurMin),100,260),this.ctx.fillText(l.convertValue(this.valeurMax),200,260)}static conversionAngle(t){return t*Math.PI/180-3*Math.PI/2}static convertValue(t){let e;return t>999?e=(t/1e3).toFixed(1)+"k":t}}var h=l;var n=class{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.etatLed=t.etatLed||0,this.width=t.width,this.height=t.width,this.scale=t.scale,this.styleBorder=t.styleBorder,this.couleur=t.couleur,this.adresseOsc=t.adresseOsc}initInterface(){var t=document.createElement("canvas");t.id=this.id+"-canvas",t.className="led",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawLed()}drawLed(){this.ctx.clearRect(0,0,300,300),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle="rgba("+this.couleur+",1)",this.ctx.arc(150,150,100,0,2*Math.PI,!1),this.ctx.stroke(),this.ctx.closePath(),this.etatLed&&(this.ctx.beginPath(),this.ctx.lineWidth=0,this.ctx.strokeStyle="rgba("+this.couleur+",1)",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.arc(150,150,80,0,2*Math.PI,!1),this.ctx.fill(),this.ctx.closePath()),this.ctx.font="24pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.legende,150,25)}receptionMessageOsc(t){this.etatLed=0!==t,this.drawLed()}};s(14);var r=class{constructor(t,e,s){this.elementDOM=t,this.scaleX=this.elementDOM.width/100*e,this.scaleY=this.elementDOM.height/100*s,this.init()}init(){this.elementDOM.getContext&&(this.context=this.elementDOM.getContext("2d"),this.context.scale(this.scaleX,this.scaleY))}drawSinus(t,e){this.elementDOM.style.backgroundColor=t,this.context.strokeStyle=e,this.context.lineWidth=4,this.context.clearRect(0,0,100,100);var s=10,i=50-40*Math.sin(this.scaleRad(10,90,s));this.context.beginPath(),this.context.moveTo(s,i);for(let t=11;t<=90;t+=1)s=t,i=50-40*Math.sin(this.scaleRad(10,90,s)),this.context.lineTo(s,i);this.context.stroke()}drawTriangle(t,e){this.elementDOM.style.backgroundColor=t,this.context.strokeStyle=e,this.context.lineWidth=4,this.context.clearRect(0,0,100,100),this.context.beginPath(),this.context.moveTo(10,50),this.context.lineTo(30,10),this.context.lineTo(70,90),this.context.lineTo(90,50),this.context.stroke()}drawSawTooth(t,e){this.elementDOM.style.backgroundColor=t,this.context.strokeStyle=e,this.context.lineWidth=4,this.context.clearRect(0,0,100,100),this.context.beginPath(),this.context.moveTo(10,50),this.context.lineTo(50,10),this.context.lineTo(50,90),this.context.lineTo(90,50),this.context.stroke()}drawSquare(t,e){this.elementDOM.style.backgroundColor=t,this.context.strokeStyle=e,this.context.lineWidth=4,this.context.clearRect(0,0,100,100),this.context.beginPath(),this.context.moveTo(10,50),this.context.lineTo(10,10),this.context.lineTo(50,10),this.context.lineTo(50,90),this.context.lineTo(90,90),this.context.lineTo(90,50),this.context.stroke()}scaleRad(t,e,s){let i;return i=(s-t)/(e-t)*Math.PI*2}};var c=class{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.type=t.type,this.valeurMinFreq=t.valeurMinFreq,this.valeurMaxFreq=t.valeurMaxFreq,this.frequency=t.frequency,this.valeurMinAmpl=t.valeurMinAmpl,this.valeurMaxAmpl=t.valeurMaxAmpl,this.amplitude=t.amplitude,this.typeVal=t.typeVal,this.etatParamVisible=!1,this.scale=t.scale||1,this.etatActive=!1,this.onValueChange=t.onvaluechange||function(){},this.adresseOsc=t.adresseOsc||""}initInterface(){let t=document.createElement("canvas");t.className="canvasMain",t.style.border="1px solid #b4b4b4",t.width=100,t.height=100,t.addEventListener("mousedown",this.switchOnOff.bind(this)),this.elementDom.appendChild(t),this.waveMainDraw=new r(t,this.scale,this.scale);let e=document.createElement("div");e.className="paramOsc",e.classList.add("hidden"),this.elementDom.appendChild(e);let s=document.createElement("div");s.className="paramWave",e.appendChild(s);let i=document.createElement("p");i.className="textParamWave",i.innerHTML="Wave",s.appendChild(i);let a=document.createElement("ul");a.className="paramWaveChoice",s.appendChild(a);let l=document.createElement("li");a.appendChild(l);let h=document.createElement("canvas");l.appendChild(h),h.className="canvasWaveSin",h.width=30,h.height=30,h.addEventListener("mousedown",this.changeType.bind(this,"sine")),l.appendChild(h),this.paramWaveSinDraw=new r(h,this.scale,this.scale);let n=document.createElement("li");a.appendChild(n);let c=document.createElement("canvas");c.className="canvasWaveTriangle",c.width=30,c.height=30,c.addEventListener("mousedown",this.changeType.bind(this,"triangle")),n.appendChild(c),this.paramWaveTriangleDraw=new r(c,this.scale,this.scale);let o=document.createElement("li");a.appendChild(o);let d=document.createElement("canvas");d.className="canvasWaveSawTooth",d.width=30,d.height=30,d.addEventListener("mousedown",this.changeType.bind(this,"sawtooth")),o.appendChild(d),this.paramWaveSawToothDraw=new r(d,this.scale,this.scale);let u=document.createElement("li");a.appendChild(u);let g=document.createElement("canvas");g.className="canvasWaveSquare",g.width=30,g.height=30,g.addEventListener("mousedown",this.changeType.bind(this,"square")),u.appendChild(g),this.paramWaveSquareDraw=new r(g,this.scale,this.scale);let x=document.createElement("ul");x.className="paramFreqAmpl",e.appendChild(x);let m=document.createElement("li");m.className="paramFreq",x.appendChild(m);let v=document.createElement("p");m.appendChild(v),v.className="textFreq",v.innerHTML="FrÃ©quence (Hz)";let p=document.createElement("div");p.id=this.id+"-knobFreq",p.className="knob",p.setAttribute("data-width","80"),p.setAttribute("data-height","80"),p.setAttribute("data-couleur","0,255,0"),p.setAttribute("data-angle-depart","30"),p.setAttribute("data-angle-arrivee","330"),p.setAttribute("data-valeur-min",this.valeurMinFreq),p.setAttribute("data-valeur-max",this.valeurMaxFreq),p.setAttribute("data-valeur-init",this.frequency),p.setAttribute("data-type-val",this.typeVal),p.setAttribute("data-adresse-osc",this.adresseOsc+"/freq"),m.appendChild(p);let b=document.createElement("li");b.className="paramAmpl",x.appendChild(b);let w=document.createElement("p");b.appendChild(w),w.className="textAmpl",w.innerHTML="Amplitude (V)";let f=document.createElement("div");f.id=this.id+"-knobAmpl",f.className="knob",f.setAttribute("data-width","80"),f.setAttribute("data-height","80"),f.setAttribute("data-couleur","0,255,0"),f.setAttribute("data-angle-depart","30"),f.setAttribute("data-angle-arrivee","330"),f.setAttribute("data-valeur-min",this.valeurMinAmpl),f.setAttribute("data-valeur-max",this.valeurMaxAmpl),f.setAttribute("data-valeur-init",this.amplitude),f.setAttribute("data-type-val",this.typeVal),f.setAttribute("data-adresse-osc",this.adresseOsc+"/ampl"),b.appendChild(f);let A=document.createElement("div");A.className="minify",A.addEventListener("mousedown",this.showParam.bind(this,e)),this.elementDom.appendChild(A);let y=document.createElement("p");A.appendChild(y),y.className="textMinify",y.innerHTML=">",this.drawOscillator()}changeType(t){this.type=t,this.drawOscillator()}showParam(t,e){this.etatParamVisible?(t.classList.remove("visible"),t.classList.add("hidden"),e.target.innerHTML=">",this.etatParamVisible=!1):(t.classList.remove("hidden"),t.classList.add("visible"),e.target.innerHTML="<",this.etatParamVisible=!0)}drawOscillator(){let t,e,s,i,a;switch(t=this.etatActive?"#A9D8FF":"#b4b4b4",e="#b4b4b4",s="#b4b4b4",i="#b4b4b4",a="#b4b4b4",this.type){case"sine":e="#deb800",this.waveMainDraw.drawSinus("#111111",t);break;case"triangle":s="#deb800",this.waveMainDraw.drawTriangle("#111111",t);break;case"sawtooth":i="#deb800",this.waveMainDraw.drawSawTooth("#111111",t);break;case"square":a="#deb800",this.waveMainDraw.drawSquare("#111111",t);break;default:e="#deb800"}this.paramWaveSinDraw.drawSinus(e,"#111111"),this.paramWaveTriangleDraw.drawTriangle(s,"#111111"),this.paramWaveSawToothDraw.drawSawTooth(i,"#111111"),this.paramWaveSquareDraw.drawSquare(a,"#111111")}on(){let t={adresseOsc:this.adresseOsc+"/on",typeVal:"i",value:1};this.onValueChange(t)}off(){let t={adresseOsc:this.adresseOsc+"/on",typeVal:"i",value:0};this.onValueChange(t)}switchOnOff(){this.etatActive?(this.etatActive=!1,this.off()):(this.etatActive=!0,this.on()),this.drawOscillator()}changeType(t){let e;switch(this.type=t,this.type){case"sine":e=0;break;case"triangle":e=1;break;case"sawtooth":e=2;break;case"square":e=3;break;default:e=0}let s={adresseOsc:this.adresseOsc+"/type",typeVal:"i",value:e};this.onValueChange(s),this.drawOscillator()}};var o=class extends c{constructor(t){super(t),this.contextAudio=t.contextAudio,this.initAudio(),this.outlet=null}initAudio(){this.oscillatorNode=this.contextAudio.createOscillator(),this.oscillatorNode.type=this.type,this.oscillatorNode.frequency.value=this.frequency,this.gainNode=this.contextAudio.createGain(),this.gainNode.gain.setValueAtTime(0,this.contextAudio.currentTime),this.oscillatorNode.connect(this.gainNode),this.oscillatorNode.start()}connectOutlet(){this.gainNode.connect(this.outlet)}on(){this.gainNode.gain.linearRampToValueAtTime(this.amplitude,this.contextAudio.currentTime+.05),this.etatActive=!0,this.drawOscillator()}off(){this.gainNode.gain.linearRampToValueAtTime(0,this.contextAudio.currentTime+.05),this.etatActive=!1,this.drawOscillator()}changeType(t){let e=!1;this.etatActive&&(e=!0),this.off(),this.oscillatorNode.stop(),this.type=t,this.initAudio(),this.connectOutlet(),e&&this.on(),this.drawOscillator()}changeAmplitude(t){this.gainNode&&this.gainNode.gain.linearRampToValueAtTime(t,this.contextAudio.currentTime+.05),this.amplitude=t}changeFrequency(t){this.oscillatorNode.frequency.value=t,this.frequency=t}};var d=class{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.couleur=t.couleur,this.width=t.width,this.height=t.height,this.scale=t.scale,this.styleBorder=t.styleBorder,this.onValueChange=t.onvaluechange||function(){},this.adresseOsc=t.adresseOsc,this.activeState=!1}initInterface(){var t=document.createElement("canvas");t.addEventListener("mousedown",this.switchOnOff.bind(this)),t.id=this.id+"-canvas",t.className="bang",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawOut()}on(){let t={adresseOsc:this.adresseOsc,typeVal:"i",value:1};this.onValueChange(t)}off(){let t={adresseOsc:this.adresseOsc,typeVal:"i",value:0};this.onValueChange(t)}switchOnOff(){this.activeState?(this.activeState=!1,this.off()):(this.activeState=!0,this.on()),this.drawOut()}drawOut(){let t;t=this.activeState?"#A9D8FF":"#b4b4b4",this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle=t,this.ctx.fillStyle=t,this.ctx.moveTo(75,195),this.ctx.lineTo(75,105),this.ctx.lineTo(110,105),this.ctx.lineTo(150,75),this.ctx.lineTo(150,225),this.ctx.lineTo(110,195),this.ctx.lineTo(75,195),this.ctx.fill(),this.ctx.closePath(),this.ctx.lineWidth=9,this.ctx.beginPath(),this.ctx.arc(150,150,25,-Math.PI/4,Math.PI/4,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(150,150,50,-Math.PI/4,Math.PI/4,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(150,150,75,-Math.PI/4,Math.PI/4,!1),this.ctx.stroke(),this.ctx.closePath()}};var u=class extends d{constructor(t){super(t),this.contextAudio=t.contextAudio,this.initAudio()}initAudio(){this.gainNode=this.contextAudio.createGain(),this.gainNode.gain.setValueAtTime(0,this.contextAudio.currentTime),this.gainNode.connect(this.contextAudio.destination)}on(){this.contextAudio.resume(),this.gainNode.gain.linearRampToValueAtTime(1,this.contextAudio.currentTime+.05),this.activeState=!0,this.drawOut()}off(){this.gainNode.gain.linearRampToValueAtTime(0,this.contextAudio.currentTime+.05),this.contextAudio.suspend(),this.activeState=!1,this.drawOut()}};var g=class{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.typeVal=t.typeVal,this.valeurMin=t.valeurMin||0,this.valeurMax=t.valeurMax||100,this.valueA=t.valeur,this.valueB=t.valeur,this.etatClic=!1,this.sourisY=0,this.couleur=t.couleur,document.body.addEventListener("mouseup",this.mouseUp.bind(this)),document.body.addEventListener("mousemove",this.getMouse.bind(this)),this.onValueChange=t.onvaluechange||function(){},this.width=t.width,this.height=t.height,this.styleBorder=t.styleBorder,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.adresseOsc=t.adresseOsc}initInterface(){var t=document.createElement("canvas");t.addEventListener("mousedown",this.mouseDown.bind(this)),t.id=this.id+"-canvas",t.className="slider",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),t.setAttribute("data-valeur-min",this.valeurMin),t.setAttribute("data-valeur-max",this.valeurMax),t.setAttribute("data-valeur-init",this.valueA),t.setAttribute("data-type-val",this.typeVal),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scaleX,this.scaleY),this.drawSlider()}setValueA(t){this.valueA=t,this.drawSlider()}setValueB(t){if(this.valueB=t,this.drawSlider(),this.adresseOsc){let t={adresseOsc:this.adresseOsc,typeVal:this.typeVal,value:this.valueB};this.onValueChange(t)}}mouseDown(t){this.sourisY=t.clientY,this.etatClic=!0}mouseUp(){this.etatClic&&this.setValueA(this.valueB),this.etatClic=!1}getMouse(t){if(this.etatClic){let e=this.valueA+(this.sourisY-t.clientY)/(2*this.height/3)*(this.valeurMax-this.valeurMin);e<this.valeurMin?e=this.valeurMin:e>this.valeurMax&&(e=this.valeurMax),e="i"===this.typeVal?parseInt(e):Math.round(10*e)/10,this.setValueB(e)}}scaleValue(t){return(t-this.valeurMin)/(this.valeurMax-this.valeurMin)*230}drawSlider(){this.ctx.clearRect(0,0,100,300),this.ctx.beginPath(),this.ctx.fillStyle="rgba(60,60,60,1)",this.ctx.fillRect(25,60,50,230),this.ctx.closePath(),this.drawCursorSlider(),this.drawTextSlider()}drawCursorSlider(){let t;this.ctx.beginPath(),this.ctx.fillStyle="rgba("+this.couleur+",0.31)",t=this.scaleValue(this.valueA),this.ctx.fillRect(25,290-t,50,t),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.fillStyle="rgba("+this.couleur+",1)",t=this.scaleValue(this.valueB),this.ctx.fillRect(25,290-t,50,t),this.ctx.closePath()}drawTextSlider(){this.ctx.font="18pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.valueB,50,45),this.ctx.font="14pt Verdana",this.ctx.fillText(this.legende,50,15),this.ctx.font="10pt Verdana",this.ctx.fillText(this.valeurMin,87,290),this.ctx.fillText(this.valeurMax,87,60)}};var x=class extends g{constructor(t){super(t),this.contextAudio=t.contextAudio,this.initAudio(),this.outlet=null}setValueB(t){if(this.valueB=t,this.drawSlider(),this.contextAudio){let t=Math.pow(10,this.valueB/20);this.changeAmplitude(t)}}initAudio(){this.gainNode=this.contextAudio.createGain();let t=Math.pow(10,this.valueA/20);this.gainNode.gain.setValueAtTime(t,this.contextAudio.currentTime)}connectOutlet(){this.gainNode.connect(this.outlet)}changeAmplitude(t){this.gainNode&&this.gainNode.gain.linearRampToValueAtTime(t,this.contextAudio.currentTime+.05)}};var m=function(t,e,s,i,a,l){t.beginPath(),t.moveTo(e,s+l),t.lineTo(e,s+a-l),t.quadraticCurveTo(e,s+a,e+l,s+a),t.lineTo(e+i-l,s+a),t.quadraticCurveTo(e+i,s+a,e+i,s+a-l),t.lineTo(e+i,s+l),t.quadraticCurveTo(e+i,s,e+i-l,s),t.lineTo(e+l,s),t.quadraticCurveTo(e,s,e,s+l),t.closePath(),t.fill()};var v=class{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende,this.etatToggle=t.etatToggle||0,this.couleur=t.couleur,this.onValueChange=t.onvaluechange||function(){},this.width=t.width,this.height=t.width,this.scale=t.scale,this.styleBorder=t.styleBorder,this.adresseOsc=t.adresseOsc}initInterface(){let t=document.createElement("canvas");t.addEventListener("mousedown",this.clic.bind(this)),t.id=this.id+"-canvas",t.className="toggle",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),t.setAttribute("data-etat-init",this.etatToggle),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawToggle()}setEtatToggle(t){this.etatToggle=t,this.drawToggle()}clic(){this.etatToggle?this.setEtatToggle(0):this.setEtatToggle(1);let t={adresseOsc:this.adresseOsc,typeVal:"i",value:this.etatToggle};this.onValueChange(t)}drawToggle(){this.ctx.clearRect(0,0,300,300),this.etatToggle?this.ctx.fillStyle="rgba("+this.couleur+",1)":this.ctx.fillStyle="rgba(60,60,60,1)",m(this.ctx,50,50,200,200,20),this.ctx.font="24pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.legende,150,25)}};class p{constructor(t){t instanceof AudioContext?(this.contextAudio=t,this.paramContext={contextAudio:t,onvaluechange:function(){}}):this.paramContext={onvaluechange:function(e){t.sendValueOsc(e)}},this.collSliders=[],this.collKnobs=[],this.collBangs=[],this.collToggles=[],this.collLeds=[],this.collOuts=[],this.collOscillators=[]}loadObjects(){this.loadOscillators(),this.loadBangs(),this.loadKnobs(),this.loadSliders(),this.loadToggles(),this.loadLeds(),this.loadOuts()}configureObjects(){this.configureOscillators()}loadSliders(){let t=document.querySelectorAll(".slider");for(let e of t){let t,s={elementDom:e,id:e.id,legende:e.dataset.legende,valeurMin:e.dataset.valeurMin,valeurMax:e.dataset.valeurMax,width:e.dataset.width,height:e.dataset.height,styleBorder:e.dataset.styleBorder,valeur:parseFloat(e.dataset.valeurInit),scaleX:parseFloat(e.dataset.width/100),scaleY:parseFloat(e.dataset.height/300),couleur:e.dataset.couleur};if(this.contextAudio||(s=p.jsonConcat(s,{adresseOsc:e.dataset.adresseOsc}),s=p.jsonConcat(s,{typeVal:e.dataset.typeVal})),s=p.jsonConcat(s,this.paramContext),(t=this.contextAudio?new x(s):new Slider(s)).initInterface(),!this.contextAudio){let e={adresseOsc:t.adresseOsc,typeVal:t.typeVal,value:t.valueA};t.onValueChange(e)}this.collSliders.push(t)}}loadKnobs(){let t=document.querySelectorAll(".knob");for(let e of t){let t,s={elementDom:e,id:e.id,legende:e.dataset.legende,angleDepart:parseInt(e.dataset.angleDepart),angleArrivee:parseInt(e.dataset.angleArrivee),valeurMin:e.dataset.valeurMin,valeurMax:e.dataset.valeurMax,valeur:parseFloat(e.dataset.valeurInit),width:e.dataset.width,height:e.dataset.width,scale:parseFloat(e.dataset.width/300),couleur:e.dataset.couleur};if(this.contextAudio||(s=p.jsonConcat(s,{adresseOsc:e.dataset.adresseOsc}),s=p.jsonConcat(s,{typeVal:e.dataset.typeVal})),s=p.jsonConcat(s,this.paramContext),(t=new h(s)).initInterface(),!this.contextAudio){let e={adresseOsc:t.adresseOsc,typeVal:t.typeVal,value:t.valeurA};t.onValueChange(e)}this.collKnobs.push(t)}}loadBangs(){let t=document.querySelectorAll(".bang");for(let e of t){let t,s={elementDom:e,id:e.id,legende:e.dataset.legende,width:e.dataset.width,scale:parseFloat(e.dataset.width/300),styleBorder:e.dataset.styleBorder,couleur:e.dataset.couleur};this.contextAudio||(s=p.jsonConcat(s,{adresseOsc:e.dataset.adresseOsc})),s=p.jsonConcat(s,this.paramContext),(t=new a(s)).initInterface(),this.collBangs.push(t)}}loadToggles(){let t=document.querySelectorAll(".toggle");for(let e of t){let t,s={elementDom:e,legende:e.dataset.legende,etatToggle:parseInt(e.dataset.etatInit),width:e.dataset.width,scale:parseFloat(e.dataset.width/300),styleBorder:e.dataset.styleBorder,couleur:e.dataset.couleur};if(this.contextAudio||(s=p.jsonConcat(s,{adresseOsc:e.dataset.adresseOsc})),s=p.jsonConcat(s,this.paramContext),(t=new v(s)).initInterface(),!this.contextAudio){let e={adresseOsc:t.adresseOsc,typeVal:"i",value:t.etatToggle};t.onValueChange(e)}this.collToggles.push(t)}}loadLeds(){let t=document.querySelectorAll(".led");for(let e of t){let t,s={elementDom:e,id:e.id,legende:e.dataset.legende,width:e.dataset.width,scale:parseFloat(e.dataset.width/300),styleBorder:e.dataset.styleBorder,couleur:e.dataset.couleur};this.contextAudio||(s=p.jsonConcat(s,{adresseOsc:e.dataset.adresseOsc})),s=p.jsonConcat(s,this.paramContext),(t=new n(s)).initInterface(),this.collLeds.push(t)}}loadOuts(){let t=document.querySelectorAll(".out");for(let e of t){let t,s={elementDom:e,id:e.id,legende:e.dataset.legende,width:e.dataset.width,height:e.dataset.height,scale:parseFloat(e.dataset.width/300),styleBorder:e.dataset.styleBorder,couleur:e.dataset.couleur};this.contextAudio||(s=p.jsonConcat(s,{adresseOsc:e.dataset.adresseOsc})),s=p.jsonConcat(s,this.paramContext),(t=this.contextAudio?new u(s):new Out(s)).initInterface(),this.collOuts.push(t)}}loadOscillators(){let t=document.querySelectorAll(".oscillator");for(let e of t){let t,s={elementDom:e,id:e.id,type:e.dataset.type,valeurMinFreq:e.dataset.valeurMinFreq,valeurMaxFreq:e.dataset.valeurMaxFreq,frequency:e.dataset.frequency,valeurMinAmpl:e.dataset.valeurMinAmpl,valeurMaxAmpl:e.dataset.valeurMaxAmpl,amplitude:e.dataset.amplitude,scale:parseFloat(e.height/100)};this.contextAudio||(s=p.jsonConcat(s,{adresseOsc:e.dataset.adresseOsc}),s=p.jsonConcat(s,{typeVal:e.dataset.typeVal})),s=p.jsonConcat(s,this.paramContext),(t=this.contextAudio?new o(s):new c(s)).initInterface(),this.collOscillators.push(t)}}configureOscillators(t){if(t)for(let t of this.collOscillators){let e=t.id+"-knobAmpl";this.getObjectById("knob",e).onValueChange=function(e){t.changeAmplitude(e.value)},e=t.id+"-knobFreq",this.getObjectById("knob",e).onValueChange=function(e){t.changeFrequency(e.value)}}}getObjectById(t,e){let s;switch(t){case"oscillator":s=this.collOscillators;break;case"bang":s=this.collBangs;break;case"toggle":s=this.collToggles;break;case"knob":s=this.collKnobs;break;case"slider":s=this.collSliders;break;case"out":s=this.collOuts}let i=document.getElementById(e);for(let t of s)if(t.elementDom===i)return t}getObjectByAddressOsc(t){let e=this.collLeds;for(let s of e)if(s.adresseOsc===t)return s}receptionMessageOsc(t,e){this.getObjectByAddressOsc(t).receptionMessageOsc(e)}static jsonConcat(t,e){for(let s in e)t[s]=e[s];return t}}var b=p;let w=document.getElementById("container"),f=new i(w.dataset.webSocketServer,w.dataset.webSocketPort),A=new b(f);!function t(){!1===f.ws.connexionState?window.setTimeout(t,100):(f.ws.receptionMessageOsc=function(t){console.log("Received from server: ",t),console.log("OSC address: "+t.address);let e=t.address;console.log("type: "+t.args[0].type+" value: "+t.args[0].value);let s=t.args[0].value;A.receptionMessageOsc(e,s)},A.loadObjects(),A.configureObjects())}()}});