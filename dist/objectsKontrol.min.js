class Bang{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.width=t.width,this.height=t.width,this.scale=t.scale,this.styleBorder=t.styleBorder,this.couleur=t.couleur,this.onValueChange=t.onvaluechange||function(){},this.adresseOsc=t.adresseOsc}initInterface(){var t=document.createElement("canvas");t.addEventListener("mousedown",this.clic.bind(this)),t.id=this.id+"-canvas",t.className="bang",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawCercle()}clic(){this.drawCercle(),this.drawBang(),this.onValueChange(this.adresseOsc,"i","1"),setTimeout(function(){this.drawCercle()}.bind(this),100)}drawCercle(){this.ctx.clearRect(0,0,300,300),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle="rgba("+this.couleur+",1)",this.ctx.arc(150,150,100,0,2*Math.PI,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.font="24pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.legende,150,25)}drawBang(){this.ctx.beginPath(),this.ctx.lineWidth=0,this.ctx.strokeStyle="rgba("+this.couleur+",0.5)",this.ctx.fillStyle="rgba("+this.couleur+",0.5)",this.ctx.arc(150,150,80,0,2*Math.PI,!1),this.ctx.fill(),this.ctx.closePath()}}function rectArrondi(t,e,i,s,a,l){t.beginPath(),t.moveTo(e,i+l),t.lineTo(e,i+a-l),t.quadraticCurveTo(e,i+a,e+l,i+a),t.lineTo(e+s-l,i+a),t.quadraticCurveTo(e+s,i+a,e+s,i+a-l),t.lineTo(e+s,i+l),t.quadraticCurveTo(e+s,i,e+s-l,i),t.lineTo(e+l,i),t.quadraticCurveTo(e,i,e,i+l),t.closePath(),t.fill()}class Draw{constructor(t,e,i){this.elementDOM=t,this.scaleX=this.elementDOM.width/100*e,this.scaleY=this.elementDOM.height/100*i,this.init()}init(){this.elementDOM.getContext&&(this.context=this.elementDOM.getContext("2d"),this.context.scale(this.scaleX,this.scaleY))}drawSinus(t,e){this.elementDOM.style.backgroundColor=t,this.context.strokeStyle=e,this.context.lineWidth=4,this.context.clearRect(0,0,100,100);var i=10,s=50-40*Math.sin(this.scaleRad(10,90,i));this.context.beginPath(),this.context.moveTo(i,s);for(let t=11;t<=90;t+=1)i=t,s=50-40*Math.sin(this.scaleRad(10,90,i)),this.context.lineTo(i,s);this.context.stroke()}drawTriangle(t,e){this.elementDOM.style.backgroundColor=t,this.context.strokeStyle=e,this.context.lineWidth=4,this.context.clearRect(0,0,100,100),this.context.beginPath(),this.context.moveTo(10,50),this.context.lineTo(30,10),this.context.lineTo(70,90),this.context.lineTo(90,50),this.context.stroke()}drawSawTooth(t,e){this.elementDOM.style.backgroundColor=t,this.context.strokeStyle=e,this.context.lineWidth=4,this.context.clearRect(0,0,100,100),this.context.beginPath(),this.context.moveTo(10,50),this.context.lineTo(50,10),this.context.lineTo(50,90),this.context.lineTo(90,50),this.context.stroke()}drawSquare(t,e){this.elementDOM.style.backgroundColor=t,this.context.strokeStyle=e,this.context.lineWidth=4,this.context.clearRect(0,0,100,100),this.context.beginPath(),this.context.moveTo(10,50),this.context.lineTo(10,10),this.context.lineTo(50,10),this.context.lineTo(50,90),this.context.lineTo(90,90),this.context.lineTo(90,50),this.context.stroke()}scaleRad(t,e,i){let s;return s=(i-t)/(e-t)*Math.PI*2}}class Knob{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.angleDepart=Knob.conversionAngle(t.angleDepart||0),this.angleArrivee=Knob.conversionAngle(t.angleArrivee||360),this.typeVal=t.typeVal,this.valeurMin=t.valeurMin||0,this.valeurMax=t.valeurMax||100,this.largeurCurseur=Math.PI/12,this.valeurA=t.valeur,this.valeurB=t.valeur,this.etatClic=!1,this.sourisY=0,this.couleur=t.couleur,document.body.addEventListener("mouseup",this.sourisUp.bind(this)),document.body.addEventListener("mousemove",this.getSouris.bind(this)),this.onValueChange=t.onvaluechange||function(){},this.width=t.width,this.height=t.height,this.scale=t.scale,this.adresseOsc=t.adresseOsc}initInterface(){var t=document.createElement("canvas");t.addEventListener("mousedown",this.sourisDown.bind(this)),t.id=this.id+"-canvas",t.className="knob",t.width=this.width,t.height=this.height,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),t.setAttribute("data-angle-depart",this.angleDepart),t.setAttribute("data-angle-arrivee",this.angleArrivee),t.setAttribute("data-valeur-min",this.valeurMin),t.setAttribute("data-valeur-max",this.valeurMax),t.setAttribute("data-valeur-init",this.valeurA),t.setAttribute("data-type-val",this.typeVal),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawKnob()}setvaleurA(t){this.valeurA=t,this.drawKnob()}setvaleurB(t){this.valeurB=t,this.drawKnob();let e={adresseOsc:this.adresseOsc,typeVal:this.typeVal,value:t};this.onValueChange(e)}sourisDown(t){this.sourisY=t.clientY,this.etatClic=!0}sourisUp(){this.etatClic&&this.setvaleurA(this.valeurB),this.etatClic=!1}getSouris(t){if(this.etatClic){let e=this.valeurA+(this.sourisY-t.clientY)/(2*this.height/3)*(this.valeurMax-this.valeurMin);e<this.valeurMin?e=this.valeurMin:e>this.valeurMax&&(e=this.valeurMax),e="i"===this.typeVal?parseInt(e):Math.round(100*e)/100,this.setvaleurB(e)}}miseEchelle(t){return(this.angleArrivee-this.angleDepart-2*this.largeurCurseur)*(t-this.valeurMin)/(this.valeurMax-this.valeurMin)+(this.angleDepart+this.largeurCurseur)}drawKnob(){this.ctx.clearRect(0,0,300,300),this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle="rgba("+this.couleur+",1)",this.ctx.arc(150,150,100,this.angleDepart,this.angleArrivee,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.font="24pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.legende,150,25),this.drawCursorKnob(),this.drawTexteKnob()}drawCursorKnob(){let t;this.ctx.beginPath(),this.ctx.lineWidth=15,this.ctx.strokeStyle="rgba("+this.couleur+",0.31)",t=this.miseEchelle(this.valeurA),this.ctx.arc(150,150,85,t-this.largeurCurseur,t+this.largeurCurseur,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.lineWidth=15,this.ctx.strokeStyle="rgba("+this.couleur+",1)",t=this.miseEchelle(this.valeurB),this.ctx.arc(150,150,85,t-this.largeurCurseur,t+this.largeurCurseur,!1),this.ctx.stroke(),this.ctx.closePath()}drawTexteKnob(){this.ctx.font="30pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(Knob.convertValue(this.valeurB),150,150),this.ctx.font="22pt Verdana",this.ctx.fillText(Knob.convertValue(this.valeurMin),100,260),this.ctx.fillText(Knob.convertValue(this.valeurMax),200,260)}static conversionAngle(t){return t*Math.PI/180-3*Math.PI/2}static convertValue(t){let e;return t>999?e=(t/1e3).toFixed(1)+"k":t}}class ObjectsKontrol{constructor(){this.collSliders=[],this.collKnobs=[],this.collBangs=[],this.collToggles=[],this.collOuts=[],this.collOscillators=[]}loadObjects(t){this.loadOscillators(t),this.loadBangs(),this.loadKnobs(),this.loadSliders(t),this.loadToggles(),this.loadOuts(t)}configureObjects(t){this.configureOscillators(t)}loadSliders(t){let e=document.querySelectorAll(".slider");for(let i of e){let e;(e=t?new SliderAudio({elementDom:i,id:i.id,legende:i.dataset.legende,typeVal:i.dataset.typeVal,valeurMin:i.dataset.valeurMin,valeurMax:i.dataset.valeurMax,width:i.dataset.width,height:i.dataset.height,styleBorder:i.dataset.styleBorder,valeur:parseFloat(i.dataset.valeurInit),scaleX:parseFloat(i.dataset.width/100),scaleY:parseFloat(i.dataset.height/300),couleur:i.dataset.couleur,onvaluechange:function(){},contextAudio:t}):new Slider({elementDom:i,id:i.id,legende:i.dataset.legende,typeVal:i.dataset.typeVal,valeurMin:i.dataset.valeurMin,valeurMax:i.dataset.valeurMax,width:i.dataset.width,height:i.dataset.height,styleBorder:i.dataset.styleBorder,valeur:parseFloat(i.dataset.valeurInit),scaleX:parseFloat(i.dataset.width/100),scaleY:parseFloat(i.dataset.height/300),couleur:i.dataset.couleur,adresseOsc:i.dataset.adresseOsc})).initInterface(),this.collSliders.push(e)}}loadKnobs(){let t=document.querySelectorAll(".knob");for(let e of t){let t;(t=new Knob({elementDom:e,id:e.id,legende:e.dataset.legende,angleDepart:parseInt(e.dataset.angleDepart),angleArrivee:parseInt(e.dataset.angleArrivee),typeVal:e.dataset.typeVal,valeurMin:e.dataset.valeurMin,valeurMax:e.dataset.valeurMax,valeur:parseFloat(e.dataset.valeurInit),width:e.dataset.width,height:e.dataset.width,scale:parseFloat(e.dataset.width/300),couleur:e.dataset.couleur,adresseOsc:e.dataset.adresseOsc})).initInterface(),this.collKnobs.push(t)}}loadBangs(){let t=document.querySelectorAll(".bang");for(let e of t){let t;(t=new Bang({elementDom:e,id:e.id,legende:e.dataset.legende,width:e.dataset.width,scale:parseFloat(e.dataset.width/300),styleBorder:e.dataset.styleBorder,couleur:e.dataset.couleur,adresseOsc:e.dataset.adresseOsc})).initInterface(),this.collBangs.push(t)}}loadToggles(){let t=document.querySelectorAll(".toggle");for(let e of t){let t;(t=new Toggle({elementDom:e,legende:e.dataset.legende,etatToggle:parseInt(e.dataset.etatInit),width:e.dataset.width,scale:parseFloat(e.dataset.width/300),styleBorder:e.dataset.styleBorder,couleur:e.dataset.couleur,adresseOsc:e.dataset.adresseOsc})).initInterface(),this.collToggles.push(t)}}loadOuts(t){let e=document.querySelectorAll(".out");for(let i of e){let e;(e=t?new OutAudio({elementDom:i,id:i.id,legende:i.dataset.legende,width:i.dataset.width,height:i.dataset.height,scale:parseFloat(i.dataset.width/300),styleBorder:i.dataset.styleBorder,couleur:i.dataset.couleur,contextAudio:t}):new Out({elementDom:i,id:i.id,legende:i.dataset.legende,width:i.dataset.width,height:i.dataset.height,scale:parseFloat(i.dataset.width/300),styleBorder:i.dataset.styleBorder,couleur:i.dataset.couleur,adresseOsc:i.dataset.adresseOsc})).initInterface(),this.collOuts.push(e)}}loadOscillators(t){let e=document.querySelectorAll(".oscillator");for(let i of e){let e;(e=t?new OscillatorAudio({elementDom:i,id:i.id,type:i.dataset.type,valeurMinFreq:i.dataset.valeurMinFreq,valeurMaxFreq:i.dataset.valeurMaxFreq,frequency:i.dataset.frequency,valeurMinAmpl:i.dataset.valeurMinAmpl,valeurMaxAmpl:i.dataset.valeurMaxAmpl,amplitude:i.dataset.amplitude,scale:parseFloat(i.height/100),contextAudio:t}):new Oscillator({elementDom:i,id:i.id,type:i.dataset.type,valeurMinFreq:i.dataset.valeurMinFreq,valeurMaxFreq:i.dataset.valeurMaxFreq,frequency:i.dataset.frequency,valeurMinAmpl:i.dataset.valeurMinAmpl,valeurMaxAmpl:i.dataset.valeurMaxAmpl,amplitude:i.dataset.amplitude,scale:parseFloat(i.height/100),adresseOsc:i.dataset.adresseOsc})).initInterface(),this.collOscillators.push(e)}}configureOscillators(t){if(t)for(let t of this.collOscillators){let e=t.id+"-knobAmpl";this.getObject("knob",e).onValueChange=function(e){t.changeAmplitude(e.value)},e=t.id+"-knobFreq",this.getObject("knob",e).onValueChange=function(e){t.changeFrequency(e.value)}}}getObject(t,e){let i;switch(t){case"oscillator":i=this.collOscillators;break;case"bang":i=this.collBangs;break;case"toggle":i=this.collToggles;break;case"knob":i=this.collKnobs;break;case"slider":i=this.collSliders;break;case"out":i=this.collOuts}let s=document.getElementById(e);for(let t of i)if(t.elementDom===s)return t}}class Oscillator{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.type=t.type,this.valeurMinFreq=t.valeurMinFreq,this.valeurMaxFreq=t.valeurMaxFreq,this.frequency=t.frequency,this.valeurMinAmpl=t.valeurMinAmpl,this.valeurMaxAmpl=t.valeurMaxAmpl,this.amplitude=t.amplitude,this.typeVal=t.typeVal,this.etatParamVisible=!1,this.scale=t.scale||1,this.etatActive=!1,this.onValueChange=t.onvaluechange||function(){},this.adresseOsc=t.adresseOsc||""}initInterface(){let t=document.createElement("canvas");t.className="canvasMain",t.style.border="1px solid #b4b4b4",t.width=100,t.height=100,t.addEventListener("mousedown",this.switchOnOff.bind(this)),this.elementDom.appendChild(t),this.waveMainDraw=new Draw(t,this.scale,this.scale);let e=document.createElement("div");e.className="paramOsc",e.classList.add("hidden"),this.elementDom.appendChild(e);let i=document.createElement("div");i.className="paramWave",e.appendChild(i);let s=document.createElement("p");s.className="textParamWave",s.innerHTML="Wave",i.appendChild(s);let a=document.createElement("ul");a.className="paramWaveChoice",i.appendChild(a);let l=document.createElement("li");a.appendChild(l);let h=document.createElement("canvas");l.appendChild(h),h.className="canvasWaveSin",h.width=30,h.height=30,h.addEventListener("mousedown",this.changeType.bind(this,"sine")),l.appendChild(h),this.paramWaveSinDraw=new Draw(h,this.scale,this.scale);let r=document.createElement("li");a.appendChild(r);let n=document.createElement("canvas");n.className="canvasWaveTriangle",n.width=30,n.height=30,n.addEventListener("mousedown",this.changeType.bind(this,"triangle")),r.appendChild(n),this.paramWaveTriangleDraw=new Draw(n,this.scale,this.scale);let c=document.createElement("li");a.appendChild(c);let o=document.createElement("canvas");o.className="canvasWaveSawTooth",o.width=30,o.height=30,o.addEventListener("mousedown",this.changeType.bind(this,"sawtooth")),c.appendChild(o),this.paramWaveSawToothDraw=new Draw(o,this.scale,this.scale);let d=document.createElement("li");a.appendChild(d);let u=document.createElement("canvas");u.className="canvasWaveSquare",u.width=30,u.height=30,u.addEventListener("mousedown",this.changeType.bind(this,"square")),d.appendChild(u),this.paramWaveSquareDraw=new Draw(u,this.scale,this.scale);let g=document.createElement("ul");g.className="paramFreqAmpl",e.appendChild(g);let m=document.createElement("li");m.className="paramFreq",g.appendChild(m);let x=document.createElement("p");m.appendChild(x),x.className="textFreq",x.innerHTML="Fréquence (Hz)";let v=document.createElement("div");v.id=this.id+"-knobFreq",v.className="knob",v.setAttribute("data-width","80"),v.setAttribute("data-height","80"),v.setAttribute("data-couleur","0,255,0"),v.setAttribute("data-angle-depart","30"),v.setAttribute("data-angle-arrivee","330"),v.setAttribute("data-valeur-min",this.valeurMinFreq),v.setAttribute("data-valeur-max",this.valeurMaxFreq),v.setAttribute("data-valeur-init",this.frequency),v.setAttribute("data-type-val",this.typeVal),m.appendChild(v);let p=document.createElement("li");p.className="paramAmpl",g.appendChild(p);let b=document.createElement("p");p.appendChild(b),b.className="textAmpl",b.innerHTML="Amplitude (V)";let w=document.createElement("div");w.id=this.id+"-knobAmpl",w.className="knob",w.setAttribute("data-width","80"),w.setAttribute("data-height","80"),w.setAttribute("data-couleur","0,255,0"),w.setAttribute("data-angle-depart","30"),w.setAttribute("data-angle-arrivee","330"),w.setAttribute("data-valeur-min",this.valeurMinAmpl),w.setAttribute("data-valeur-max",this.valeurMaxAmpl),w.setAttribute("data-valeur-init",this.amplitude),w.setAttribute("data-type-val",this.typeVal),p.appendChild(w);let A=document.createElement("div");A.className="minify",A.addEventListener("mousedown",this.showParam.bind(this,e)),this.elementDom.appendChild(A);let y=document.createElement("p");A.appendChild(y),y.className="textMinify",y.innerHTML=">",this.drawOscillator()}changeType(t){this.type=t,this.drawOscillator()}showParam(t,e){this.etatParamVisible?(t.classList.remove("visible"),t.classList.add("hidden"),e.target.innerHTML=">",this.etatParamVisible=!1):(t.classList.remove("hidden"),t.classList.add("visible"),e.target.innerHTML="<",this.etatParamVisible=!0)}drawOscillator(){let t,e,i,s,a;switch(t=this.etatActive?"#A9D8FF":"#b4b4b4",e="#b4b4b4",i="#b4b4b4",s="#b4b4b4",a="#b4b4b4",this.type){case"sine":e="#deb800",this.waveMainDraw.drawSinus("#111111",t);break;case"triangle":i="#deb800",this.waveMainDraw.drawTriangle("#111111",t);break;case"sawtooth":s="#deb800",this.waveMainDraw.drawSawTooth("#111111",t);break;case"square":a="#deb800",this.waveMainDraw.drawSquare("#111111",t);break;default:e="#deb800"}this.paramWaveSinDraw.drawSinus(e,"#111111"),this.paramWaveTriangleDraw.drawTriangle(i,"#111111"),this.paramWaveSawToothDraw.drawSawTooth(s,"#111111"),this.paramWaveSquareDraw.drawSquare(a,"#111111")}on(){}off(){}switchOnOff(){this.etatActive?(this.off(),this.etatActive=!1):(this.on(),this.etatActive=!0)}changeType(t){this.type=t,this.drawOscillator()}changeAmplitude(t){}}class OscillatorAudio extends Oscillator{constructor(t){super(t),this.contextAudio=t.contextAudio,this.initAudio(),this.outlet=null}initAudio(){this.oscillatorNode=this.contextAudio.createOscillator(),this.oscillatorNode.type=this.type,this.oscillatorNode.frequency.value=this.frequency,this.gainNode=this.contextAudio.createGain(),this.gainNode.gain.setValueAtTime(0,this.contextAudio.currentTime),this.oscillatorNode.connect(this.gainNode),this.oscillatorNode.start()}connectOutlet(){this.gainNode.connect(this.outlet)}on(){this.gainNode.gain.linearRampToValueAtTime(this.amplitude,this.contextAudio.currentTime+.05),this.etatActive=!0,this.drawOscillator()}off(){this.gainNode.gain.linearRampToValueAtTime(0,this.contextAudio.currentTime+.05),this.etatActive=!1,this.drawOscillator()}changeType(t){let e=!1;this.etatActive&&(e=!0),this.off(),this.oscillatorNode.stop(),this.type=t,this.initAudio(),this.connectOutlet(),e&&this.on(),this.drawOscillator()}changeAmplitude(t){this.gainNode&&this.gainNode.gain.linearRampToValueAtTime(t,this.contextAudio.currentTime+.05),this.amplitude=t}changeFrequency(t){this.oscillatorNode.frequency.value=t,this.frequency=t}}class Out{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.couleur=t.couleur,this.width=t.width,this.height=t.height,this.scale=t.scale,this.styleBorder=t.styleBorder,this.onValueChange=t.onvaluechange||function(){},this.adresseOsc=t.adresseOsc,this.etatActive=!1}initInterface(){var t=document.createElement("canvas");t.addEventListener("mousedown",this.switchOnOff.bind(this)),t.id=this.id+"-canvas",t.className="bang",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawOut()}on(){}off(){}switchOnOff(){this.etatActive?(this.off(),this.etatActive=!1):(this.on(),this.etatActive=!0)}drawOut(){let t;t=this.etatActive?"#A9D8FF":"#b4b4b4",this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.strokeStyle=t,this.ctx.fillStyle=t,this.ctx.moveTo(75,195),this.ctx.lineTo(75,105),this.ctx.lineTo(110,105),this.ctx.lineTo(150,75),this.ctx.lineTo(150,225),this.ctx.lineTo(110,195),this.ctx.lineTo(75,195),this.ctx.fill(),this.ctx.closePath(),this.ctx.lineWidth=9,this.ctx.beginPath(),this.ctx.arc(150,150,25,-Math.PI/4,Math.PI/4,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(150,150,50,-Math.PI/4,Math.PI/4,!1),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(150,150,75,-Math.PI/4,Math.PI/4,!1),this.ctx.stroke(),this.ctx.closePath()}}class OutAudio extends Out{constructor(t){super(t),this.contextAudio=t.contextAudio,this.initAudio()}initAudio(){this.gainNode=this.contextAudio.createGain(),this.gainNode.gain.setValueAtTime(0,this.contextAudio.currentTime),this.gainNode.connect(this.contextAudio.destination)}on(){this.contextAudio.resume(),this.gainNode.gain.linearRampToValueAtTime(1,this.contextAudio.currentTime+.05),this.etatActive=!0,this.drawOut()}off(){this.gainNode.gain.linearRampToValueAtTime(0,this.contextAudio.currentTime+.05),this.contextAudio.suspend(),this.etatActive=!1,this.drawOut()}}class Slider{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende||"",this.typeVal=t.typeVal,this.valeurMin=t.valeurMin||0,this.valeurMax=t.valeurMax||100,this.valueA=t.valeur,this.valueB=t.valeur,this.etatClic=!1,this.sourisY=0,this.couleur=t.couleur,document.body.addEventListener("mouseup",this.mouseUp.bind(this)),document.body.addEventListener("mousemove",this.getMouse.bind(this)),this.onValueChange=t.onvaluechange||function(){},this.width=t.width,this.height=t.height,this.styleBorder=t.styleBorder,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.adresseOsc=t.adresseOsc}initInterface(){var t=document.createElement("canvas");t.addEventListener("mousedown",this.mouseDown.bind(this)),t.id=this.id+"-canvas",t.className="slider",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),t.setAttribute("data-valeur-min",this.valeurMin),t.setAttribute("data-valeur-max",this.valeurMax),t.setAttribute("data-valeur-init",this.valueA),t.setAttribute("data-type-val",this.typeVal),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scaleX,this.scaleY),this.drawSlider()}setValueA(t){this.valueA=t,this.drawSlider()}setValueB(t){this.valueB=t,this.drawSlider(),this.adresseOsc&&this.onValueChange(this.adresseOsc,this.typeVal,this.valueB)}mouseDown(t){this.sourisY=t.clientY,this.etatClic=!0}mouseUp(){this.etatClic&&this.setValueA(this.valueB),this.etatClic=!1}getMouse(t){if(this.etatClic){let e=this.valueA+(this.sourisY-t.clientY)/(2*this.height/3)*(this.valeurMax-this.valeurMin);e<this.valeurMin?e=this.valeurMin:e>this.valeurMax&&(e=this.valeurMax),e="i"===this.typeVal?parseInt(e):Math.round(10*e)/10,this.setValueB(e)}}scaleValue(t){return(t-this.valeurMin)/(this.valeurMax-this.valeurMin)*230}drawSlider(){this.ctx.clearRect(0,0,100,300),this.ctx.beginPath(),this.ctx.fillStyle="rgba(60,60,60,1)",this.ctx.fillRect(25,60,50,230),this.ctx.closePath(),this.drawCursorSlider(),this.drawTextSlider()}drawCursorSlider(){let t;this.ctx.beginPath(),this.ctx.fillStyle="rgba("+this.couleur+",0.31)",t=this.scaleValue(this.valueA),this.ctx.fillRect(25,290-t,50,t),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.fillStyle="rgba("+this.couleur+",1)",t=this.scaleValue(this.valueB),this.ctx.fillRect(25,290-t,50,t),this.ctx.closePath()}drawTextSlider(){this.ctx.font="18pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.valueB,50,45),this.ctx.font="14pt Verdana",this.ctx.fillText(this.legende,50,15),this.ctx.font="10pt Verdana",this.ctx.fillText(this.valeurMin,87,290),this.ctx.fillText(this.valeurMax,87,60)}}class SliderAudio extends Slider{constructor(t){super(t),this.contextAudio=t.contextAudio,this.initAudio(),this.outlet=null}setValueB(t){if(this.valueB=t,this.drawSlider(),this.contextAudio){let t=Math.pow(10,this.valueB/20);this.changeAmplitude(t)}}initAudio(){this.gainNode=this.contextAudio.createGain();let t=Math.pow(10,this.valueA/20);this.gainNode.gain.setValueAtTime(t,this.contextAudio.currentTime)}connectOutlet(){this.gainNode.connect(this.outlet)}changeAmplitude(t){this.gainNode&&this.gainNode.gain.linearRampToValueAtTime(t,this.contextAudio.currentTime+.05)}}class Toggle{constructor(t){this.elementDom=t.elementDom,this.id=t.id,this.legende=t.legende,this.etatToggle=t.etatToggle||0,this.couleur=t.couleur,this.onValueChange=t.onvaluechange||function(){},this.width=t.width,this.height=t.width,this.scale=t.scale,this.styleBorder=t.styleBorder,this.adresseOsc=t.adresseOsc}initInterface(){let t=document.createElement("canvas");t.addEventListener("mousedown",this.clic.bind(this)),t.id=this.id+"-canvas",t.className="toggle",t.width=this.width,t.height=this.height,t.style.border=this.styleBorder,t.setAttribute("data-legende",this.legende),t.setAttribute("data-couleur",this.couleur),t.setAttribute("data-etat-init",this.etatToggle),this.elementDom.appendChild(t),this.ctx=t.getContext("2d"),this.ctx.scale(this.scale,this.scale),this.drawToggle()}setEtatToggle(t){this.etatToggle=t,this.drawToggle()}clic(){this.etatToggle?this.setEtatToggle(0):this.setEtatToggle(1),this.onValueChange(this.adresseOsc,"i",this.etatToggle)}drawToggle(){this.ctx.clearRect(0,0,300,300),this.etatToggle?this.ctx.fillStyle="rgba("+this.couleur+",1)":this.ctx.fillStyle="rgba(60,60,60,1)",rectArrondi(this.ctx,50,50,200,200,20),this.ctx.font="24pt Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba("+this.couleur+",1)",this.ctx.fillText(this.legende,150,25)}}